---
title: 开发问题记录
categories: js-end
date: 2020-06-09 17:24:28
---

## h5网页判断微信、小程序环境
```javascript
<script src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>
export function isWeChatMiniApp() {
  const ua = window.navigator.userAgent.toLowerCase();
  return new Promise((resolve) => {
    if (ua.indexOf('micromessenger') == -1) {
      console.log("不在微信或者小程序中")
      resolve(false);
    } else {
      wx.miniProgram.getEnv((res) => {
        if (res.miniprogram) {
          console.log("在小程序中")
          resolve(true);
        } else {//在微信中
          console.log("在微信中")
          resolve(false);
        }
      });
    }
  });
}
```
```
在网页内可通过window.__wxjs_environment变量判断是否在小程序环境，建议在WeixinJSBridgeReady回调中使用，也可以使用JSSDK 1.3.2提供的getEnv接口。
https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html
```
## 
```javascript

```